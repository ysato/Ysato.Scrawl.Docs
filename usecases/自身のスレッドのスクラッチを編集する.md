#### ユースケース名: 自身のスレッドのスクラッチを編集する

* **アクター:** 登録ユーザー (ログインユーザー)
* **目的:** 自身のスレッドに投稿したスクラッチの内容を修正する。
* **関連するHTMLモック画面:** 自身のスレッド詳細画面 (スクラッチの横に編集ボタンがあるイメージ)

---

**1. 事前条件:**

* ユーザーはWebアプリケーションにログインしている。
* ユーザーは自身のスレッド詳細画面を閲覧している。
* 閲覧しているスレッドに、ログインユーザー自身が投稿したスクラッチが存在する。
* 各スクラッチには、編集をトリガーするためのUI（例: 編集アイコン、または「編集」ボタンなど）が存在する。

**2. 基本的な流れ（正常系）:**

1. **ユーザーは自身のスレッド詳細画面を開く。**
2. **ユーザーは編集したい自身のスクラッチを見つけ、そのスクラッチの横にある編集用のUIを操作する。**
    * システムは該当スクラッチの表示をテキスト入力フィールド（Markdownエディタなど）に切り替え、現在のスクラッチ内容が入力済み状態で表示される。
    * 編集モードを終了するためのUI（例: 保存ボタン、キャンセルボタンなど）が表示される。
3. **ユーザーはスクラッチ入力フィールドでスクラッチ内容を修正する。**
4. **ユーザーは「保存」ボタンをクリックするか、所定の操作（例: Enterキー押下など）を行う。**
5. **システムは入力された新しいスクラッチ内容を検証する。**
    * スクラッチが空でないか、特定の文字数制限などをチェックする。
6. **検証が成功した場合、システムはデータベースの該当スクラッチを更新する。**
    * スクラッチの更新日時も同時に更新される。
7. **システムはスクラッチ一覧の表示を更新されたスクラッチ内容に切り替え、編集モードを終了する。**
    * この際、保存成功を通知するメッセージ（例: 「スクラッチが更新されました」）を表示する。

---

**3. 代替の流れ（例外系、エラーなど）:**

* **A. スクラッチが未入力（空）になった場合:**
    1. ユーザーが保存操作を行う。
    2. システムはスクラッチ入力欄が空であることを検知する。
    3. システムはスクラッチ入力欄の近くにエラーメッセージ（例: 「スクラッチは必須です」）を表示し、保存処理を中断する。スクラッチは編集前の状態に戻るか、編集モードが維持される。
* **B. スクラッチが長すぎる場合:**
    1. ユーザーが保存操作を行う。
    2. システムは入力されたスクラッチが規定の文字数を超えていることを検知する。
    3. システムはスクラッチ入力欄の近くにエラーメッセージ（例:
       「スクラッチは〇〇文字以内で入力してください」）を表示し、保存処理を中断する。スクラッチは編集前の状態に戻るか、編集モードが維持される。
* **C. 保存せずに編集モードをキャンセルした場合:**
    1. ユーザーが編集モードに切り替えた後、変更内容を破棄する操作（例: 「キャンセル」ボタンをクリック、Escキー押下など）を行う。
    2. システムは変更内容を破棄し、スクラッチ表示を編集前の状態に戻し、編集モードを終了する。
* **D. 自身のスクラッチ以外を編集しようとした場合:**
    1. ユーザーが他のユーザーのスクラッチの編集UIを操作する。（本来はUI上で編集できないようにすべきだが、念のため考慮）
    2. システムは操作ユーザーとスクラッチ作成ユーザーが一致しないことを検知する。
    3. システムはエラーメッセージ（例: 「他のユーザーのスクラッチは編集できません」）を表示し、処理を中断する。
* **E. システムエラーが発生した場合:**
    1. ユーザーが保存操作を行う。
    2. データベース更新中に予期せぬエラーが発生する。
    3. システムは一般的なエラーメッセージ（例: 「スクラッチ更新中にエラーが発生しました。時間をおいて再度お試しください。」）を表示し、スクラッチは編集前の状態に戻るか、編集モードが維持される。

---

**4. 事後条件:**

* スクラッチが正常に更新された場合: データベースの該当スクラッチが変更され、ユーザーはスレッド詳細画面で更新されたスクラッチを確認できる。
* スクラッチが更新されなかった場合: ユーザーはスレッド詳細画面に留まり、エラーメッセージが表示されるか、編集モードが維持される。

